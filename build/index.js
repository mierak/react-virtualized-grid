"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),r=(e=t)&&"object"==typeof e&&"default"in e?e.default:e;function n(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],l=0,c=i.length;l<c;l++,o++)n[o]=i[l];return n}var o=function(e,t){var r;return function(){for(var n=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var l=function(){return e.apply(n,o)};clearTimeout(r),r=setTimeout(l,t)}},i=function(e){var t={};return e.forEach((function(e){t["--"+e[0]]=e[1]})),t},l=function(e){var t=e.columns,o=e.rows,i=e.rowHeight,l=e.gapSize;return r.createElement(r.Fragment,null,n(Array(t)).map((function(e,t){return r.createElement("div",{key:t,style:{height:o*(i+l)}})})))},c=[],u=[];!function(e,t){if(e&&"undefined"!=typeof document){var r,n=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var l=c.indexOf(i);-1===l&&(l=c.push(i)-1,u[l]={}),r=u[l]&&u[l][n]?u[l][n]:u[l][n]=a()}else r=a();65279===e.charCodeAt(0)&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function a(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var r=Object.keys(t.attributes),o=0;o<r.length;o++)e.setAttribute(r[o],t.attributes[r[o]]);var l="prepend"===n?"afterbegin":"beforeend";return i.insertAdjacentElement(l,e),e}}(".container {\r\n\t--grid-gap: 5px;\r\n\t--grid-height: 100vh;\r\n\t--grid-columns: '2';\r\n\tdisplay: grid;\r\n\tgrid-template-columns: var(--grid-columns);\r\n\tgrid-gap: var(--grid-gap);\r\n\toverflow-y: auto;\r\n\twidth: 100%;\r\n\tmax-height: 100vh;\r\n\theight: var(--grid-height);\r\n}\r\n\r\n.cell {\r\n\t--cell-height: 40px;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tbox-sizing: border-box;\r\n\theight: var(--cell-height);\r\n}\r\n",{});var a=function(e){var t=i([["cell-height",e.height+"px"]]);return r.createElement("div",{className:"cell",style:t},e.children)};exports.VirtualizedGrid=function(e){var c,u,s,f,h=t.useRef(null),d=t.useRef({value:0}),g=t.useState({rows:0,columns:0}),m=g[0],v=g[1],p=t.useState({from:0,to:30}),y=p[0],w=p[1],x=null!==(c=e.debounceDelay)&&void 0!==c?c:300,b=null!==(u=e.prerenderScreens)&&void 0!==u?u:3,H=null!==(s=e.gridGap)&&void 0!==s?s:0;t.useLayoutEffect((function(){h.current&&d.current.value!==h.current.scrollTop&&(h.current.scrollTop=d.current.value)}),[d.current.value]),t.useEffect((function(){var t=h.current,r=e.scrollToIndex,n=e.itemCount,o=e.rowHeight;if(t&&r){var i=t.scrollHeight,l=t.clientHeight,c=i*(Math.floor(r/m.columns)/Math.floor(n/m.columns))-(l/2-o/2);t.scrollTo({top:c})}}),[m.columns,e,e.itemCount,e.rowHeight,e.scrollToIndex]),t.useEffect((function(){if(h.current){var t=Math.floor(h.current.clientWidth/(e.cellWidth+H)),r=Math.ceil(e.itemCount/t);v({columns:t,rows:r})}}),[H,e.cellWidth,e.itemCount]),t.useEffect((function(){var t=h.current,r=o((function(){var t=h.current;if(t){var r=Math.floor(t.clientWidth/(e.cellWidth+H)),n=Math.ceil(e.itemCount/r);v({columns:r,rows:n})}}),0),n=new ResizeObserver(r);return t&&n.observe(t),function(){t&&n.unobserve(t)}}),[H,e.cellWidth,e.debounceDelay,e.itemCount]);var E=o((function(t){var r=Math.ceil(t.clientHeight/(e.rowHeight+H)),n=Math.max(0,Math.floor(t.scrollTop/(e.rowHeight+H))-r*b),o=Math.min(m.rows,n+r*(2*b+1));w(n>o?{from:m.rows-(y.to-y.from),to:m.rows}:{from:n,to:o})}),x),T=function(t,n){return void 0===n&&(n=!0),n?r.createElement(l,{columns:m.columns,rows:t,rowHeight:e.rowHeight,gapSize:H}):null},M=i([["grid-gap",e.gridGap+"px"],["grid-height",e.gridHeight?"string"==typeof e.gridHeight?e.gridHeight:e.gridHeight+"px":"100vh"],["grid-columns","repeat("+m.columns+", minmax("+e.cellWidth+"px, 1fr))"]]);return r.createElement("div",{className:"container "+(null!==(f=e.className)&&void 0!==f?f:""),ref:h,style:M,onScroll:function(e){E(e.currentTarget),h.current&&(d.current.value=h.current.scrollTop)}},T(y.from,y.from>0),n(Array(y.to-y.from)).map((function(t,o){return n(Array(m.columns)).map((function(t,n){var i=(o+y.from)*m.columns+n;return i<e.itemCount?r.createElement(a,{key:o*m.columns+n,height:e.rowHeight},e.children(i,o+y.from,n)):null}))})),T(m.rows-y.to,y.to<m.rows))};
