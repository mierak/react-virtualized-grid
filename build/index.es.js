import e,{useRef as r,useState as t,useLayoutEffect as n,useEffect as o}from"react";function i(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var i=arguments[r],l=0,c=i.length;l<c;l++,o++)n[o]=i[l];return n}var l=function(e,r){var t;return function(){for(var n=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var l=function(){return e.apply(n,o)};clearTimeout(t),t=setTimeout(l,r)}},c=function(e){var r={};return e.forEach((function(e){r["--"+e[0]]=e[1]})),r},u=function(r){var t=r.columns,n=r.rows,o=r.rowHeight,l=r.gapSize;return e.createElement(e.Fragment,null,i(Array(t)).map((function(r,t){return e.createElement("div",{key:t,style:{height:n*(o+l)}})})))},a=[],s=[];!function(e,r){if(e&&"undefined"!=typeof document){var t,n=!0===r.prepend?"prepend":"append",o=!0===r.singleTag,i="string"==typeof r.container?document.querySelector(r.container):document.getElementsByTagName("head")[0];if(o){var l=a.indexOf(i);-1===l&&(l=a.push(i)-1,s[l]={}),t=s[l]&&s[l][n]?s[l][n]:s[l][n]=c()}else t=c();65279===e.charCodeAt(0)&&(e=e.substring(1)),t.styleSheet?t.styleSheet.cssText+=e:t.appendChild(document.createTextNode(e))}function c(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),r.attributes)for(var t=Object.keys(r.attributes),o=0;o<t.length;o++)e.setAttribute(t[o],r.attributes[t[o]]);var l="prepend"===n?"afterbegin":"beforeend";return i.insertAdjacentElement(l,e),e}}(".container {\r\n\t--grid-gap: 5px;\r\n\t--grid-height: 100vh;\r\n\t--grid-columns: '2';\r\n\tdisplay: grid;\r\n\tgrid-template-columns: var(--grid-columns);\r\n\tgrid-gap: var(--grid-gap);\r\n\toverflow-y: auto;\r\n\twidth: 100%;\r\n\tmax-height: 100vh;\r\n\theight: var(--grid-height);\r\n}\r\n\r\n.cell {\r\n\t--cell-height: 40px;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tbox-sizing: border-box;\r\n\theight: var(--cell-height);\r\n}\r\n",{});var h=function(r){var t=c([["cell-height",r.height+"px"]]);return e.createElement("div",{className:"cell",style:t},r.children)},g=function(a){var s,g,m,d,f=r(null),v=r({value:0}),p=t({rows:0,columns:0}),y=p[0],w=p[1],x=t({from:0,to:30}),b=x[0],H=x[1],T=null!==(s=a.debounceDelay)&&void 0!==s?s:300,E=null!==(g=a.prerenderScreens)&&void 0!==g?g:3,M=null!==(m=a.gridGap)&&void 0!==m?m:0;n((function(){f.current&&v.current.value!==f.current.scrollTop&&(f.current.scrollTop=v.current.value)}),[v.current.value]),o((function(){var e=f.current,r=a.scrollToIndex,t=a.itemCount,n=a.rowHeight;if(e&&r){var o=e.scrollHeight,i=e.clientHeight,l=o*(Math.floor(r/y.columns)/Math.floor(t/y.columns))-(i/2-n/2);e.scrollTo({top:l})}}),[y.columns,a,a.itemCount,a.rowHeight,a.scrollToIndex]),o((function(){if(f.current){var e=Math.floor(f.current.clientWidth/(a.cellWidth+M)),r=Math.ceil(a.itemCount/e);w({columns:e,rows:r})}}),[M,a.cellWidth,a.itemCount]),o((function(){var e=f.current,r=l((function(){var e=f.current;if(e){var r=Math.floor(e.clientWidth/(a.cellWidth+M)),t=Math.ceil(a.itemCount/r);w({columns:r,rows:t})}}),0),t=new ResizeObserver(r);return e&&t.observe(e),function(){e&&t.unobserve(e)}}),[M,a.cellWidth,a.debounceDelay,a.itemCount]);var C=l((function(e){var r=Math.ceil(e.clientHeight/(a.rowHeight+M)),t=Math.max(0,Math.floor(e.scrollTop/(a.rowHeight+M))-r*E),n=Math.min(y.rows,t+r*(2*E+1));H(t>n?{from:y.rows-(b.to-b.from),to:y.rows}:{from:t,to:n})}),T),A=function(r,t){return void 0===t&&(t=!0),t?e.createElement(u,{columns:y.columns,rows:r,rowHeight:a.rowHeight,gapSize:M}):null},S=c([["grid-gap",a.gridGap+"px"],["grid-height",a.gridHeight?"string"==typeof a.gridHeight?a.gridHeight:a.gridHeight+"px":"100vh"],["grid-columns","repeat("+y.columns+", minmax("+a.cellWidth+"px, 1fr))"]]);return e.createElement("div",{className:"container "+(null!==(d=a.className)&&void 0!==d?d:""),ref:f,style:S,onScroll:function(e){C(e.currentTarget),f.current&&(v.current.value=f.current.scrollTop)}},A(b.from,b.from>0),i(Array(b.to-b.from)).map((function(r,t){return i(Array(y.columns)).map((function(r,n){var o=(t+b.from)*y.columns+n;return o<a.itemCount?e.createElement(h,{key:t*y.columns+n,height:a.rowHeight},a.children(o,t+b.from,n)):null}))})),A(y.rows-b.to,b.to<y.rows))};export{g as VirtualizedGrid};
